<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Dialectical Bridge - Tri·∫øt h·ªçc 4.0</title>
    <link rel="stylesheet" href="main.css?v=11">
    <script>
        // T·ª± ƒë·ªông redirect sang intro.html n·∫øu kh√¥ng ƒë·∫øn t·ª´ intro
        if (!sessionStorage.getItem('from_intro')) {
            window.location.href = 'intro.html';
        }
    </script>
</head>
<body>
    <!-- Main Menu Screen - HIDDEN -->
    <div id="main-menu" class="hidden">
        <div class="menu-content">
            <h1 class="game-title">üåâ The Dialectical Bridge</h1>
            <h2 class="game-subtitle">Tri·∫øt h·ªçc 4.0</h2>
            <p class="game-description">H√†nh tr√¨nh t·ª´ Ti·ªÉu h·ªçc ƒë·∫øn ƒê·∫°i h·ªçc</p>
            <button id="start-button" onclick="startGame()">START</button>
            <div class="game-info">
                <p>üéØ 16 c·∫•p ƒë·ªô th·ª≠ th√°ch</p>
                <p>üìö T√≠ch l≈©y L∆Ø·ª¢NG ƒë·ªÉ th·ª±c hi·ªán b∆∞·ªõc nh·∫£y CH·∫§T</p>
                <p>‚ö†Ô∏è C·∫©n th·∫≠n v·ªõi ƒêi·ªÉm N√∫t!</p>
            </div>
        </div>
    </div>

    <div id="game-container">
        <div id="ui-layer">
            <h2 id="level-name">Ti·ªÉu H·ªçc C∆° S·ªü - L·ªõp 1</h2>
            <p id="instruction">Nh·∫•n gi·ªØ chu·ªôt ƒë·ªÉ t√≠ch l≈©y L∆Ø·ª¢NG (ƒë·ªô d√†i c·∫ßu)</p>
            <div id="score-board">
                C·∫•p ƒë·ªô: <span id="score">1 / 16</span> | 
                M·∫°ng: <span id="lives-display">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
            </div>
        </div>

        <div id="world">
            <!-- C√°c c·ªôt n·ªÅn ƒë·ªÉ t·∫°o chi·ªÅu s√¢u -->
            <div id="bg-pillars">
                <div class="bg-pillar" style="left: 30%; height: 150px; width: 60px;"></div>
                <div class="bg-pillar" style="left: 50%; height: 180px; width: 50px;"></div>
                <div class="bg-pillar" style="left: 70%; height: 140px; width: 55px;"></div>
                <div class="bg-pillar" style="left: 85%; height: 160px; width: 45px;"></div>
            </div>
            <div id="player">üë∂</div>
            <div id="countdown-display"></div>
            
            <!-- Dialogue Notification -->
            <div id="dialogue-notification">
                <div id="dialogue-text"></div>
                <button id="dialogue-skip" style="display: none; margin-top: 10px; padding: 8px 20px; background: #ffd700; color: #2c3e50; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">B·ªè qua ‚è©</button>
            </div>
            
            <div id="bridge"></div>
            <div id="pillar-container">
                <div id="passed-pillars"></div>
                <div id="pillar-current" class="pillar"></div>
                <div id="pillar-next" class="pillar"></div>
            </div>
        </div>

        <div id="message-overlay" class="hidden">
            <div class="message-content">
                <h1 id="msg-title"></h1>
                <p id="msg-desc"></p>
                <button onclick="handleRetry()">Th·ª≠ l·∫°i (R√∫t kinh nghi·ªám)</button>
            </div>
        </div>

        <!-- Quiz Overlay for Checkpoint -->
        <div id="quiz-overlay" class="hidden">
            <div class="quiz-content">
                <h2 id="quiz-title">K·ª≤ thi Chuy·ªÉn c·∫•p</h2>
                <div id="quiz-timer">‚è±Ô∏è Th·ªùi gian: <span id="time-left">0</span>s</div>
                <div id="quiz-progress">C√¢u <span id="current-question">1</span> / <span id="total-questions">0</span></div>
                <div id="question-container">
                    <p id="question-text"></p>
                    <div id="answers-container"></div>
                </div>
                <button id="submit-answer" onclick="submitAnswer()" disabled>Ti·∫øp theo</button>
            </div>
        </div>

        <!-- Tutorial Overlay -->
        <div id="tutorial-overlay" class="hidden">
            <div class="tutorial-content">
                <h2 id="tutorial-title"></h2>
                <div id="tutorial-progress">B∆∞·ªõc <span id="tutorial-step">1</span> / <span id="tutorial-total">3</span></div>
                <p id="tutorial-text"></p>
                <button id="tutorial-next" onclick="nextTutorialStep()">Ti·∫øp theo ‚û°Ô∏è</button>
            </div>
        </div>
    </div>

    <script src="dialogues.js"></script>
    <script src="main.js"></script>
    <script>
        // T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu game khi load trang
        window.addEventListener('DOMContentLoaded', () => {
            initGame();
        });
    </script>
</body>
</html>